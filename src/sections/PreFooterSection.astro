---
export interface Props {
  latitude?: number;
  longitude?: number;
  locationName?: string;
}

const { 
  latitude = 32.7157,
  longitude = -117.1611,
  locationName = "San Diego, CA"
} = Astro.props;
---

<section class="w-full bg-gradient-to-br from-white via-surface/20 to-white/80 backdrop-blur-lg">
  <div class="w-full justify-between flex flex-col md:flex-row items-center gap-12">
    <div class="flex-1 px-5 md:px-20 lg:px-40 flex flex-col mb-8 md:mb-0">
      <h2 class="text-4xl md:text-5xl font-extrabold mb-3 text-heading-light">
        Let's Solve Your Plumbing Problems—<span class="text-accent">Today</span>
      </h2>
      <p class="text-lg text-body-light mb-5 max-w-lg">
        Our expert team is ready to help with fast, friendly, and reliable service. Whether you need emergency repairs, a new installation, or just some advice, we're here for you.
      </p>
      <ul class="mb-6 space-y-2 text-body-light text-base max-w-md text-left">
        <li class="flex items-center gap-2"><span class="text-accent">✔️</span> 24/7 Emergency Response</li>
        <li class="flex items-center gap-2"><span class="text-accent">✔️</span> Upfront, Transparent Pricing</li>
        <li class="flex items-center gap-2"><span class="text-accent">✔️</span> Licensed & Insured Professionals</li>
        <li class="flex items-center gap-2"><span class="text-accent">✔️</span> 100% Satisfaction Guarantee</li>
      </ul>
    </div>
    <div class="flex-1 w-full flex items-stretch">
      <div class="h-[70vh] w-[50vw] flex-1 overflow-hidden shadow-2xl shadow-black bg-white/70 backdrop-blur-lg flex items-stretch rounded-2xl">
        <div 
          id="map" 
          class="w-full h-full rounded-2xl"
          data-latitude={latitude}
          data-longitude={longitude}
          data-location-name={locationName}
        ></div>
      </div>
    </div>
  </div>
</section>

<!-- Leaflet CSS -->
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

<script>
  // Initialize the map when the DOM is loaded
  document.addEventListener('DOMContentLoaded', function() {
    const mapElement = document.getElementById('map');
    if (!mapElement) return;
    
    const mapLatitude = parseFloat(mapElement.dataset.latitude || '32.7157');
    const mapLongitude = parseFloat(mapElement.dataset.longitude || '-117.1611');
    const mapLocationName = mapElement.dataset.locationName || 'San Diego, CA';
    
    // Create the map
    const map = L.map('map').setView([mapLatitude, mapLongitude], 13);
    
    // Add OpenStreetMap tiles
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '© OpenStreetMap contributors'
    }).addTo(map);
    
    // Add a marker for the location
    const marker = L.marker([mapLatitude, mapLongitude]).addTo(map);
    marker.bindPopup(`<b>${mapLocationName}</b><br>Our Location`).openPopup();
    
    // Add some styling to the map container
    mapElement.style.borderRadius = '1rem';
  });
</script>

<script>
  // TypeScript declaration for Leaflet
  declare global {
    const L: any;
  }
</script> 