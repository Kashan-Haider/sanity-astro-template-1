---
const { items = [] } = Astro.props;
---
<section
  id="gallery"
  class="w-full py-20 px-4 bg-gradient-to-br from-surface via-surface/80 to-surface"
  x-data={`{ selected: 0, items: ${JSON.stringify(items)} }`}
  x-init="selected = 0"
>
  <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  <div class="max-w-7xl mx-auto">
    <h2 class="text-4xl md:text-5xl font-extrabold text-center mb-4 text-white">Gallery Highlights</h2>
    <p class="text-lg text-center mb-12 text-white/70 max-w-2xl mx-auto">Explore our recent projects and see the difference our team makes. Each gallery item features a unique solution and a story of success.</p>
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
      <!-- Featured item -->
      <template x-if="items[selected]">
        <div class="md:row-span-2 md:col-span-2 relative group overflow-hidden rounded-3xl shadow-2xl min-h-[350px] flex flex-col justify-end transition-all duration-500">
          <img :src="items[selected].image" :alt="items[selected].heading" class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-105" loading="lazy" />
          <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"></div>
          <div class="relative z-10 p-8">
            <h3 class="text-3xl font-bold text-white mb-2" x-text="items[selected].heading"></h3>
            <p class="text-lg text-white/80 mb-4" x-text="items[selected].description"></p>
            <template x-if="items[selected].cta">
              <a :href="items[selected].cta.href" class="inline-block px-5 py-2 rounded-lg bg-primary text-on-primary font-semibold shadow-md transition-all duration-300 hover:bg-accent hover:text-on-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2" x-text="items[selected].cta.label"></a>
            </template>
          </div>
        </div>
      </template>
      <!-- Thumbnails -->
      <div class="flex flex-col gap-8">
        <template x-for="(item, i) in items" :key="i">
          <button type="button"
            class="relative group overflow-hidden rounded-2xl shadow-xl min-h-[160px] flex flex-col justify-end outline-none focus:ring-2 focus:ring-accent transition-all duration-300"
            :class="{ 'ring-4 ring-accent': selected === i }"
            @click="selected = i"
            :aria-label="item.heading"
            :tabindex="selected === i ? -1 : 0">
            <img :src="item.image" :alt="item.heading" class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-105" loading="lazy" />
            <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"></div>
            <div class="relative z-10 p-5">
              <h4 class="text-xl font-bold text-white mb-1" x-text="item.heading"></h4>
              <p class="text-white/80 text-sm mb-2" x-text="item.description"></p>
              <template x-if="item.cta">
                <a :href="item.cta.href" class="inline-block px-4 py-1.5 rounded bg-primary text-on-primary font-semibold shadow transition-all duration-300 hover:bg-accent hover:text-on-primary focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 text-sm" x-text="item.cta.label"></a>
              </template>
            </div>
            <span x-show="selected === i" class="absolute inset-0 ring-4 ring-accent rounded-2xl pointer-events-none transition-all duration-300"></span>
          </button>
        </template>
      </div>
    </div>
  </div>
</section> 